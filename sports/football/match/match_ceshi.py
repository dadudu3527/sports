import time
import pymongo
import json

from config import config

client = pymongo.MongoClient(config)
dbnameFootball = client['football']
collection = dbnameFootball['player']
note = collection.find({"imageLogo": "undefined"},{'_id':0})
def save(data):
    with open('C:\\sports\\football\\data\\player_logo.json','a',encoding='utf-8') as f:
                f.write(json.dumps(data,ensure_ascii=False)+',\n')
def read_note():
    with open('C:\\sports\\football\\data\\player_logo.json','r',encoding='utf-8') as f:
                data = f.read()
                items = data.split(',\n')
                items.remove('')
                for item in items:
                    ne = json.loads(item)
                    playerId = ne.get('playerId')
                    print(playerId)
                    jilv = collection.find_one({'playerId':playerId})
                    if jilv:
                        collection.update_one({'playerId':playerId},{'$set':ne})
# for i in note:
    # playerId = i.get('playerId')
    # i.pop('imageLogo')
    # i.pop('honor')
    # # save(i)
    # collection.remove({'playerId':playerId})
    
while True:
    print('开始更新球员资料')
    read_note()
    time.sleep(60*60)
    
    
# read_note()

   
    
    
    
# note = collection.find_one({'playerId':25192},{'_id':0})
# note2 = collection.find_one({'playerId':21829},{'_id':0})
# note.pop('imageLogo')
# note2.pop('imageLogo')
# note.pop('honor')
# note2.pop('honor')
# collection.remove({'playerId':25192})
# collection.remove({'playerId':21829})
# time.sleep(60*20)
# collection.update_one({'playerId':25192},{'$set':note})
# collection.update_one({'playerId':21829},{'$set':note2})

# pan = note.get('initGoalLine').get('goalLine')
# print(pan)
# col_read = dbnameFootball['season']
# lia = [7555, 6, 9012, 12, 15, 18, 6177, 24, 7538, 8734, 5180, 5181, 8782, 8999, 9007, 8904, 72, 8567, 7519, 5192, 8760, 93, 96, 8796, 113, 116, 9068, 9069, 124, 8862, 127, 9090, 8788, 9017, 4981, 8890, 8846, 8772, 9087, 9091, 147, 6960, 8930, 156, 7575, 168, 5195, 8780, 9023, 9025, 201, 9011, 5583, 8936, 8799, 8731, 8724, 9194, 8656, 9147, 290, 8713, 9070, 5617, 313, 7280, 329, 330, 333, 8803, 342, 345, 347, 348, 9156, 7213, 361, 6799, 364, 8711, 8445, 372, 375, 9005, 5206, 8626, 9157, 8571, 9021, 9048, 9042, 9041, 9102, 9094, 9093, 9159, 9154, 9161, 8718, 8647, 8648, 8674, 491, 495, 9055, 9189, 9187, 8749, 8776, 9029, 564, 8759, 574, 8628, 8594, 8605, 8661, 9121, 9168, 8629, 8707, 617, 8700, 8719, 9170, 5223, 8925, 8835, 9178, 8723, 9092, 9101, 9125, 8699, 8687, 8672, 8507, 8757, 8768, 9067, 9073, 9095, 9061, 9174, 9162, 8698, 9030, 8662, 9183, 9032, 869, 5671, 9026, 9033, 9120, 9135, 8652, 8657, 8736, 9148, 9185, 9104, 9151, 8630, 8631, 8670, 9140, 9191, 9046, 9052, 9053, 9054, 9166, 8646, 8871, 8671, 9113, 9196, 9027, 9035, 1173, 1176, 8632, 9038, 8679, 9077, 9105, 5748, 8649, 8568, 8728, 5761, 9149, 9078, 8690, 8790, 8849, 8963, 8966, 8873, 8944, 8962, 8298, 9015, 1354, 8715, 8950, 8956, 8985, 8938, 8834, 1426, 8789, 8822, 8976, 8940, 8943, 8986, 1497, 8920, 9020, 9085, 9083, 8608, 9180, 8610, 9108, 1560, 9192, 8717, 8633, 9056, 9057, 9109, 8569, 9119, 9045, 9063, 9072, 8634, 8798, 8814, 8913, 9181, 1726, 9103, 9112, 8573, 1756, 8751, 9022, 9024, 9117, 9110, 8980, 9124, 9096, 8868, 9018, 9043, 9050, 9115, 8586, 9193, 1875, 9039, 9051, 9100, 9165, 8522, 9167, 8404, 9065, 9075, 9106, 8523, 9173, 9107, 9150, 1994, 9089, 8746, 8658, 9071, 9190, 9176, 9097, 5277, 9040, 9036, 9136, 8369, 8829, 8830, 8994, 8992, 8997, 8887, 8869, 8866, 8864, 8824, 8981, 8804, 8811, 8825, 8812, 8895, 8959, 8916, 9004, 8403, 8915, 8973, 8971, 9019, 8901, 8949, 8987, 9066, 8600, 8611, 8739, 9179, 9079, 9099, 8637, 2342, 8720, 2362, 2370, 8653, 9137, 9160, 8619, 8668, 2414, 2417, 8616, 8763, 2429, 8664, 2443, 2444, 9197, 2452, 9047, 8638, 9184, 9058, 9060, 8722, 9080, 9074, 9158, 8623, 2553, 9138, 8701, 8769, 8725, 9062, 9034, 8542, 9028, 8644, 8702, 8752, 9177, 9128, 9134, 8612, 8695, 8919, 8965, 8934, 9059, 8709, 8859, 8910, 8917, 8955, 9086, 8820, 8933, 8964, 8991, 9139, 8587, 8714, 9081, 8665, 9084, 8579, 8735, 8705, 8783, 8681, 2866, 9132, 8747, 8926, 8972, 8902, 8903, 8975, 8601, 8778, 9171, 8639, 8650, 8708, 8839, 8721, 8640, 8847, 8791, 9008, 8792, 8885, 5607, 9001, 8750, 9143, 9142, 8843, 8945, 7710, 7137, 9122, 4900, 7399, 8935, 5051, 8762, 8141, 8365, 8411, 8034, 3080, 3081, 9126, 8399, 8535, 8536, 8990, 8730, 3094, 8262, 9169, 8329, 8693, 9127, 8654, 9144, 8823, 8977, 8810, 9145, 8666, 8905, 8953, 8787, 8815, 8802, 8805, 8806, 8807, 8808, 8836, 8809, 8838, 8819, 8821, 8841, 8865, 8800, 9049, 8832, 9031, 5687, 8927, 9141, 8773, 8984, 9009, 8828, 8921, 8974, 6770, 8993, 6683, 8876, 8877, 8937, 8947, 9064, 9082, 9152, 9118, 8498, 8793, 8988, 8884, 5350, 8880, 3419, 8840, 8861, 8879, 8870, 8842, 9164, 8831, 5175, 9146, 8998, 9013, 9111, 3521, 9133, 9155, 8431, 5058, 8794, 8863, 3570, 8669, 3578, 7325, 8685, 9172, 3599, 7567, 7026, 3619, 8385, 3625, 7613, 8602, 8613, 3639, 8886, 8677, 3650, 3658, 3660, 3664, 3670, 8252, 8465, 8816, 8741, 3694, 8678, 3699, 6798, 8753, 7494, 8703, 9153, 3719, 3721, 3729, 7561, 9186, 8939, 3746, 9076, 7064, 8928, 3750, 3751, 3752, 4909, 4911, 5361, 5360, 8756, 8872, 8914, 8929, 8562, 8983, 8689, 8844, 3802, 3803, 3804, 3805, 3806, 8892, 8908, 7422, 7423, 8748, 3830, 3837, 8797, 3847, 9163, 8813, 8078, 3870, 7442, 8691, 5695, 7427, 8801, 8851, 8853, 8931, 8941, 8948, 8878, 3920, 3924, 8907, 8883, 9003, 8740, 8942, 7361, 8765, 5698, 8967, 8850, 8893, 8891, 8951, 8978, 9002, 8922, 5005, 8501, 8912, 8874, 8882, 8894, 8888, 8923, 8968, 8860, 8755, 8898, 8897, 8744, 8881, 4139, 4140, 4141, 8845, 9037, 4153, 9129, 9098, 8911, 8899, 8875, 8946, 8909, 8712, 7698, 8675, 8667, 8742, 8758, 7481, 4208, 8795, 7457, 7514, 8539, 8618, 8680, 8527, 9131, 8761, 8732, 8683, 4294, 8852, 8546, 7208, 8854, 8855, 8961, 9182, 4362, 4363, 9195, 8706, 8729, 8682, 8784, 4392, 8995, 8581, 8837, 6802, 8339, 5392, 4430, 4433, 4438, 8655, 8924, 7334, 8856, 8867, 8957, 8896, 8396, 8659, 8684, 8954, 8779, 8786, 4533, 8624, 8710, 8785, 8696, 8858, 9130, 8697, 8745, 8726, 6972, 8487, 8932, 8889, 8970, 8952, 8833, 9044, 4632, 8996, 9000, 8777, 8918, 8960, 8989, 9006, 8900, 8826, 8848, 5511, 7312, 5657, 5532, 5543, 5549, 8592, 8694, 8738, 6688, 9198, 9199, 8857, 7595, 5477, 8958, 8081, 8982, 5528, 9016, 8238, 9014, 5552, 9188, 8528, 5553, 8781, 8775, 7231, 9175, 9114, 8642, 8566, 8743, 8827, 8550, 8660, 8370, 8563, 8716, 8737, 8614, 8615, 8766, 8570, 8733, 8754, 8019, 8767]
# li = []
# for i in lia:
    # note = col_read.find_one({'seasonId':i})
    # if not note:
        # li.append(i)
        # # print(i)
# print(li)
        
    
